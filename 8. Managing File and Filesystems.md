# Linux File System
* Hệ thống tệp (file) Linux là một tập hợp có cấu trúc các tệp trên ổ đĩa hoặc một phân vùng. Phân vùng là một phân đoạn bộ nhớ và chứa một số dữ liệu cụ thể. Trong máy của chúng ta, có thể có nhiều phân vùng bộ nhớ khác nhau. Nói chung, mọi phân vùng đều chứa một hệ thống tệp.
* Hệ thống máy tính đa năng cần lưu trữ dữ liệu một cách có hệ thống để chúng ta có thể dễ dàng truy cập các tệp trong thời gian ngắn hơn. Nó lưu trữ dữ liệu trên đĩa cứng (HDD) hoặc một số loại lưu trữ tương đương. Có thể có những lý do dưới đây để duy trì hệ thống tệp:

    * Chủ yếu máy tính lưu dữ liệu vào bộ nhớ RAM; nó có thể mất dữ liệu nếu nó bị tắt. Tuy nhiên, có sẵn RAM bất biến (RAM Flash và SSD) để duy trì dữ liệu sau khi ngắt nguồn.

    * Việc lưu trữ dữ liệu được ưu tiên trên ổ cứng so với RAM tiêu chuẩn vì RAM tốn nhiều dung lượng hơn dung lượng đĩa. Chi phí đĩa cứng đang giảm dần so với RAM.
* Hệ thống tệp Linux chứa các phần sau:

    * Thư mục gốc (/)

    * Định dạng lưu trữ dữ liệu cụ thể (EXT3, EXT4, BTRFS, XFS, v.v.)

    * Một phân vùng hoặc ổ đĩa hợp lý có một hệ thống tệp cụ thể.
## Cấu trúc hệ thống tệp Linux
* Hệ thống tệp Linux có cấu trúc tệp phân cấp vì nó chứa thư mục gốc và các thư mục con của nó.ất cả các thư mục khác có thể được truy cập từ thư mục gốc. Một phân vùng thường chỉ có một hệ thống tệp, nhưng nó có thể có nhiều hơn một hệ thống tệp.

*  Hệ thống tệp được thiết kế theo cách để nó có thể quản lý và cung cấp không gian cho dữ liệu lưu trữ không thay đổi. Tất cả các hệ thống tệp đều yêu cầu một không gian tên là phương pháp đặt tên và tổ chức. Không gian tên xác định quy trình đặt tên, độ dài của tên tệp hoặc một tập hợp con các ký tự có thể được sử dụng cho tên tệp. Nó cũng xác định cấu trúc logic của các tệp trên một phân đoạn bộ nhớ, chẳng hạn như việc sử dụng các thư mục để tổ chức các tệp cụ thể. Khi không gian tên được mô tả, mô tả Siêu dữ liệu phải được xác định cho tệp cụ thể đó.

* Cấu trúc dữ liệu cần hỗ trợ cấu trúc thư mục phân cấp; cấu trúc này được sử dụng để mô tả không gian đĩa có sẵn và được sử dụng cho một khối cụ thể. Nó cũng có các chi tiết khác về tệp như kích thước tệp, ngày và giờ tạo, cập nhật và sửa đổi lần cuối.
* Ngoài ra, nó lưu trữ thông tin nâng cao về phần của đĩa, chẳng hạn như phân vùng và ổ đĩa.

* Dữ liệu nâng cao và cấu trúc mà nó đại diện chứa thông tin về hệ thống tệp được lưu trữ trên ổ đĩa; nó khác biệt và độc lập với siêu dữ liệu hệ thống tệp.

* Hệ thống tệp Linux chứa kiến ​​trúc triển khai phần mềm hệ thống tệp gồm hai phần. Hãy xem xét hình ảnh dưới đây:

![image](https://user-images.githubusercontent.com/91528234/199150030-927ce7b2-c770-48e8-86f5-70b0e92f6eeb.png)

* Hệ thống tệp yêu cầu một API (Giao diện lập trình ứng dụng) để truy cập các lệnh gọi hàm để tương tác với các thành phần của hệ thống tệp như tệp và thư mục. API hỗ trợ các tác vụ như tạo, xóa và sao chép tệp. Nó tạo điều kiện cho một thuật toán xác định sự sắp xếp của các tệp trên một hệ thống tệp.

* Hai phần đầu tiên của hệ thống tệp nhất định được gọi là hệ thống tệp ảo Linux. Nó cung cấp một bộ lệnh duy nhất để hạt nhân và các nhà phát triển truy cập vào hệ thống tệp. Hệ thống tệp ảo này yêu cầu trình điều khiển hệ thống cụ thể cung cấp giao diện cho hệ thống tệp.
## Các tính năng của hệ thống tệp Linux
* Trong Linux, hệ thống tệp tạo ra một cấu trúc cây. Tất cả các tệp được sắp xếp như một cái cây và các nhánh của nó. Thư mục trên cùng được gọi là thư mục gốc (/). Tất cả các thư mục khác trong Linux có thể được truy cập từ thư mục gốc.

* Một số tính năng chính của hệ thống tệp Linux như sau:

    * **Chỉ định đường dẫn**: Sử dụng dấu gạch chéo (/) để chia các thành phần. Dữ liệu sẽ được lưu trữ trong /home/MyDocument/Work.

    * **Phân vùng, Thư mục và Ổ đĩa**: Linux không sử dụng ký tự ổ đĩa để tổ chức ổ đĩa như Windows. Trong Linux,  không thể biết liệu chúng đang định địa chỉ một phân vùng, một thiết bị mạng hay một thư mục "thông thường" và một Ổ đĩa.

    * **Phân biệt chữ hoa chữ thường**: Hệ thống tệp Linux phân biệt chữ hoa chữ thường. Nó phân biệt giữa tên tệp viết thường và viết hoa. Chẳng hạn, có sự khác biệt giữa test.txt và Test.txt trong Linux. Quy tắc này cũng được áp dụng cho các thư mục và lệnh Linux.

    * **Phần mở rộng tệp**: Trong Linux, tệp có thể có phần mở rộng là '.txt', nhưng không nhất thiết tệp phải có phần mở rộng tệp. Trong khi làm việc với Shell, nó tạo ra một số vấn đề cho người mới bắt đầu để phân biệt giữa các tệp và thư mục. Nếu chúng ta sử dụng trình quản lý tệp đồ họa, nó tượng trưng cho các tệp và thư mục.

    * **Tệp ẩn**: Linux phân biệt giữa tệp tiêu chuẩn và tệp ẩn, hầu hết các tệp cấu hình được ẩn trong Hệ điều hành Linux. Thông thường, chúng ta không cần truy cập hoặc đọc các tệp ẩn. Các tệp ẩn trong Linux được biểu thị bằng dấu chấm (.) Trước tên tệp (ví dụ: .ignore). Để truy cập các tệp, chúng ta cần thay đổi chế độ xem trong trình quản lý tệp hoặc cần sử dụng một lệnh cụ thể trong trình bao.
 ## Các loại hệ thống tệp Linux
 * Khi chúng ta cài đặt hệ điều hành Linux, Linux cung cấp nhiều hệ thống tệp như Ext, Ext2, Ext3, Ext4, JFS, ReiserFS, XFS, btrfs và swap.
 ![image](https://user-images.githubusercontent.com/91528234/199150947-0ed029a9-49bb-4fbd-b38b-541b2e71dd5f.png)
 ### Ext, Ext2, Ext3 and Ext4 file system
 * Hệ thống tập tin Ext là viết tắt của **Extended File System**. Nó chủ yếu được phát triển cho **MINIX OS**. Hệ thống tệp Ext là phiên bản cũ hơn và không còn được sử dụng do một số hạn chế.

* **Ext2** là hệ thống tệp Linux đầu tiên cho phép quản lý hai terabyte dữ liệu. Ext3 được phát triển thông qua Ext2; nó là phiên bản nâng cấp của Ext2 và có khả năng tương thích ngược. Hạn chế lớn của Ext3 là không hỗ trợ máy chủ vì hệ thống tệp này không hỗ trợ khôi phục tệp và ảnh chụp nhanh đĩa.

* Hệ thống tệp **Ext4** là hệ thống tệp nhanh hơn trong số tất cả các hệ thống tệp Ext. Đây là một tùy chọn rất tương thích cho các đĩa SSD (ổ thể rắn) và nó là hệ thống tệp mặc định trong bản phân phối Linux.
### JFS File System
* **JFS** là viết tắt của **Journaled File System**, và nó được **IBM phát triển cho AIX Unix**. Nó là một thay thế cho hệ thống tệp Ext. Nó cũng có thể được sử dụng thay cho Ext4, nơi cần sự ổn định với ít tài nguyên. Nó là một hệ thống tệp tiện dụng khi sức mạnh của CPU bị hạn chế.

### Hệ thống tệp ReiserFS

**ReiserFS** là một giải pháp thay thế cho hệ thống tệp Ext3. Nó đã được cải thiện hiệu suất và các tính năng nâng cao. Trong thời gian trước đó, ReiserFS được sử dụng làm hệ thống tệp mặc định trong SUSE Linux, nhưng sau đó nó đã thay đổi một số chính sách nên SUSE quay trở lại Ext3. Hệ thống tệp này hỗ trợ động phần mở rộng tệp, nhưng nó có một số hạn chế về hiệu suất.


### Hệ thống tệp XFS

* Hệ thống tệp **XFS** được coi là JFS tốc độ cao, được phát triển để xử lý I/O song song. NASA vẫn đang sử dụng hệ thống tệp này với máy chủ lưu trữ cao (máy chủ 300+ Terabyte).

### Hệ thống tệp Btrfs

* **Btrfs** là viết tắt của hệ thống tệp B cây. Nó được sử dụng để chịu lỗi, sửa chữa hệ thống, quản trị vui vẻ, cấu hình lưu trữ mở rộng và hơn thế nữa. Nó không phải là một phù hợp tốt cho hệ thống sản xuất.

### Hoán đổi hệ thống tệp

Hệ thống tệp hoán đổi được sử dụng để phân trang bộ nhớ trong hệ điều hành Linux trong chế độ ngủ đông của hệ thống. Một hệ thống không bao giờ ở trạng thái ngủ đông bắt buộc phải có không gian hoán đổi bằng với kích thước RAM của nó.

# Lệnh Fsck trong linux (sửa chữa hệ thống tập tin)
* fsck (kiểm tra hệ thống tệp) là một tiện ích dòng lệnh cho phép bạn thực hiện kiểm tra tính nhất quán và sửa chữa tương tác trên một hoặc nhiều hệ thống tệp Linux. Nó sử dụng các chương trình dành riêng cho loại hệ thống tập tin mà nó kiểm tra.
## Cách sử dụng fsck
Lệnh fsck có dạng chung sau:
```
fsck
```
* Chỉ người dùng root hoặc người dùng có quyền sudo có thể xóa bộ đệm.

* Khi không có `FILESYSTEM` nào được cung cấp làm đối số, fsck kiểm tra các thiết bị được liệt kê trong tệp fstab .

* Không bao giờ chạy fsck trên các phân vùng được gắn vì nó có thể làm hỏng hệ thống tệp. Trước khi thử kiểm tra hoặc sửa chữa các hệ thống tập tin luôn `unmount` nó trước.

* Lệnh fsck là một trình bao bọc cho các trình kiểm tra hệ thống tệp Linux khác nhau ( fsck.* ) Và chấp nhận các tùy chọn khác nhau tùy thuộc vào loại hệ thống tệp.

Kiểm tra các trang hướng dẫn để biết thêm thông tin về một trình kiểm tra cụ thể. Ví dụ: để xem các tùy chọn khả dụng cho fsck.ext4 , hãy nhập:
```
man fsck.ext4
```
## Khi nào thì dùng fsck trong Linux
* Có nhiều tình huống khác nhau khi bạn muốn chạy fsck. Dưới đây là một số ví dụ:

* Hệ thống không khởi động được.

* Các tệp trên hệ thống bị hỏng (thường thì bạn có thể thấy lỗi đầu vào/đầu ra).

* Ổ đĩa đính kèm (bao gồm ổ đĩa flash/thẻ SD) không hoạt động như mong đợi.
## Các tùy chọn có sẵn của fsck
* Lệnh Fsck cần được chạy với các đặc quyền của superuser hoặc **root**. Bạn có thể sử dụng nó với các đối số khác nhau. Việc sử dụng chúng tùy thuộc vào trường hợp cụ thể của bạn. Dưới đây, bạn sẽ thấy một số tùy chọn quan trọng hơn:
|COMMAND| ACTION |
| :---- | :---- |
-A | – Used for checking all filesystems. The list is taken from /etc/fstab.
-C | – Show progress bar.
-l | – Locks the device to guarantee no other program will try to use the partition during the check.
-M | – Do not check mounted filesystems.
-N | – Only show what would be done – no actual changes are made.
-P | – If you want to check filesystems in parallel, including root.
-R | – Do not check root filesystem. This is useful only with ‘-A‘.
-r | – Provide statistics for each device that is being checked.
-T | – Does not show the title.
-t | – Exclusively specify the filesystem types to be checked. Types can be comma separated list.
-V | – Provide description what is being done.
