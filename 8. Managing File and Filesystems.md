# Linux File System
* Há»‡ thá»‘ng tá»‡p (file) Linux lÃ  má»™t táº­p há»£p cÃ³ cáº¥u trÃºc cÃ¡c tá»‡p trÃªn á»• Ä‘Ä©a hoáº·c má»™t phÃ¢n vÃ¹ng. PhÃ¢n vÃ¹ng lÃ  má»™t phÃ¢n Ä‘oáº¡n bá»™ nhá»› vÃ  chá»©a má»™t sá»‘ dá»¯ liá»‡u cá»¥ thá»ƒ. Trong mÃ¡y cá»§a chÃºng ta, cÃ³ thá»ƒ cÃ³ nhiá»u phÃ¢n vÃ¹ng bá»™ nhá»› khÃ¡c nhau. NÃ³i chung, má»i phÃ¢n vÃ¹ng Ä‘á»u chá»©a má»™t há»‡ thá»‘ng tá»‡p.
* Há»‡ thá»‘ng mÃ¡y tÃ­nh Ä‘a nÄƒng cáº§n lÆ°u trá»¯ dá»¯ liá»‡u má»™t cÃ¡ch cÃ³ há»‡ thá»‘ng Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng truy cáº­p cÃ¡c tá»‡p trong thá»i gian ngáº¯n hÆ¡n. NÃ³ lÆ°u trá»¯ dá»¯ liá»‡u trÃªn Ä‘Ä©a cá»©ng (HDD) hoáº·c má»™t sá»‘ loáº¡i lÆ°u trá»¯ tÆ°Æ¡ng Ä‘Æ°Æ¡ng. CÃ³ thá»ƒ cÃ³ nhá»¯ng lÃ½ do dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ duy trÃ¬ há»‡ thá»‘ng tá»‡p:

    * Chá»§ yáº¿u mÃ¡y tÃ­nh lÆ°u dá»¯ liá»‡u vÃ o bá»™ nhá»› RAM; nÃ³ cÃ³ thá»ƒ máº¥t dá»¯ liá»‡u náº¿u nÃ³ bá»‹ táº¯t. Tuy nhiÃªn, cÃ³ sáºµn RAM báº¥t biáº¿n (RAM Flash vÃ  SSD) Ä‘á»ƒ duy trÃ¬ dá»¯ liá»‡u sau khi ngáº¯t nguá»“n.

    * Viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Æ°á»£c Æ°u tiÃªn trÃªn á»• cá»©ng so vá»›i RAM tiÃªu chuáº©n vÃ¬ RAM tá»‘n nhiá»u dung lÆ°á»£ng hÆ¡n dung lÆ°á»£ng Ä‘Ä©a. Chi phÃ­ Ä‘Ä©a cá»©ng Ä‘ang giáº£m dáº§n so vá»›i RAM.
* Há»‡ thá»‘ng tá»‡p Linux chá»©a cÃ¡c pháº§n sau:

    * ThÆ° má»¥c gá»‘c (/)

    * Äá»‹nh dáº¡ng lÆ°u trá»¯ dá»¯ liá»‡u cá»¥ thá»ƒ (EXT3, EXT4, BTRFS, XFS, v.v.)

    * Má»™t phÃ¢n vÃ¹ng hoáº·c á»• Ä‘Ä©a há»£p lÃ½ cÃ³ má»™t há»‡ thá»‘ng tá»‡p cá»¥ thá»ƒ.
## Cáº¥u trÃºc há»‡ thá»‘ng tá»‡p Linux
* Há»‡ thá»‘ng tá»‡p Linux cÃ³ cáº¥u trÃºc tá»‡p phÃ¢n cáº¥p vÃ¬ nÃ³ chá»©a thÆ° má»¥c gá»‘c vÃ  cÃ¡c thÆ° má»¥c con cá»§a nÃ³.áº¥t cáº£ cÃ¡c thÆ° má»¥c khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p tá»« thÆ° má»¥c gá»‘c. Má»™t phÃ¢n vÃ¹ng thÆ°á»ng chá»‰ cÃ³ má»™t há»‡ thá»‘ng tá»‡p, nhÆ°ng nÃ³ cÃ³ thá»ƒ cÃ³ nhiá»u hÆ¡n má»™t há»‡ thá»‘ng tá»‡p.

*  Há»‡ thá»‘ng tá»‡p Ä‘Æ°á»£c thiáº¿t káº¿ theo cÃ¡ch Ä‘á»ƒ nÃ³ cÃ³ thá»ƒ quáº£n lÃ½ vÃ  cung cáº¥p khÃ´ng gian cho dá»¯ liá»‡u lÆ°u trá»¯ khÃ´ng thay Ä‘á»•i. Táº¥t cáº£ cÃ¡c há»‡ thá»‘ng tá»‡p Ä‘á»u yÃªu cáº§u má»™t khÃ´ng gian tÃªn lÃ  phÆ°Æ¡ng phÃ¡p Ä‘áº·t tÃªn vÃ  tá»• chá»©c. KhÃ´ng gian tÃªn xÃ¡c Ä‘á»‹nh quy trÃ¬nh Ä‘áº·t tÃªn, Ä‘á»™ dÃ i cá»§a tÃªn tá»‡p hoáº·c má»™t táº­p há»£p con cÃ¡c kÃ½ tá»± cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cho tÃªn tá»‡p. NÃ³ cÅ©ng xÃ¡c Ä‘á»‹nh cáº¥u trÃºc logic cá»§a cÃ¡c tá»‡p trÃªn má»™t phÃ¢n Ä‘oáº¡n bá»™ nhá»›, cháº³ng háº¡n nhÆ° viá»‡c sá»­ dá»¥ng cÃ¡c thÆ° má»¥c Ä‘á»ƒ tá»• chá»©c cÃ¡c tá»‡p cá»¥ thá»ƒ. Khi khÃ´ng gian tÃªn Ä‘Æ°á»£c mÃ´ táº£, mÃ´ táº£ SiÃªu dá»¯ liá»‡u pháº£i Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh cho tá»‡p cá»¥ thá»ƒ Ä‘Ã³.

* Cáº¥u trÃºc dá»¯ liá»‡u cáº§n há»— trá»£ cáº¥u trÃºc thÆ° má»¥c phÃ¢n cáº¥p; cáº¥u trÃºc nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ´ táº£ khÃ´ng gian Ä‘Ä©a cÃ³ sáºµn vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng cho má»™t khá»‘i cá»¥ thá»ƒ. NÃ³ cÅ©ng cÃ³ cÃ¡c chi tiáº¿t khÃ¡c vá» tá»‡p nhÆ° kÃ­ch thÆ°á»›c tá»‡p, ngÃ y vÃ  giá» táº¡o, cáº­p nháº­t vÃ  sá»­a Ä‘á»•i láº§n cuá»‘i.
* NgoÃ i ra, nÃ³ lÆ°u trá»¯ thÃ´ng tin nÃ¢ng cao vá» pháº§n cá»§a Ä‘Ä©a, cháº³ng háº¡n nhÆ° phÃ¢n vÃ¹ng vÃ  á»• Ä‘Ä©a.

* Dá»¯ liá»‡u nÃ¢ng cao vÃ  cáº¥u trÃºc mÃ  nÃ³ Ä‘áº¡i diá»‡n chá»©a thÃ´ng tin vá» há»‡ thá»‘ng tá»‡p Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn á»• Ä‘Ä©a; nÃ³ khÃ¡c biá»‡t vÃ  Ä‘á»™c láº­p vá»›i siÃªu dá»¯ liá»‡u há»‡ thá»‘ng tá»‡p.

* Há»‡ thá»‘ng tá»‡p Linux chá»©a kiáº¿n â€‹â€‹trÃºc triá»ƒn khai pháº§n má»m há»‡ thá»‘ng tá»‡p gá»“m hai pháº§n. HÃ£y xem xÃ©t hÃ¬nh áº£nh dÆ°á»›i Ä‘Ã¢y:

![image](https://user-images.githubusercontent.com/91528234/199150030-927ce7b2-c770-48e8-86f5-70b0e92f6eeb.png)

* Há»‡ thá»‘ng tá»‡p yÃªu cáº§u má»™t API (Giao diá»‡n láº­p trÃ¬nh á»©ng dá»¥ng) Ä‘á»ƒ truy cáº­p cÃ¡c lá»‡nh gá»i hÃ m Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c thÃ nh pháº§n cá»§a há»‡ thá»‘ng tá»‡p nhÆ° tá»‡p vÃ  thÆ° má»¥c. API há»— trá»£ cÃ¡c tÃ¡c vá»¥ nhÆ° táº¡o, xÃ³a vÃ  sao chÃ©p tá»‡p. NÃ³ táº¡o Ä‘iá»u kiá»‡n cho má»™t thuáº­t toÃ¡n xÃ¡c Ä‘á»‹nh sá»± sáº¯p xáº¿p cá»§a cÃ¡c tá»‡p trÃªn má»™t há»‡ thá»‘ng tá»‡p.

* Hai pháº§n Ä‘áº§u tiÃªn cá»§a há»‡ thá»‘ng tá»‡p nháº¥t Ä‘á»‹nh Ä‘Æ°á»£c gá»i lÃ  há»‡ thá»‘ng tá»‡p áº£o Linux. NÃ³ cung cáº¥p má»™t bá»™ lá»‡nh duy nháº¥t Ä‘á»ƒ háº¡t nhÃ¢n vÃ  cÃ¡c nhÃ  phÃ¡t triá»ƒn truy cáº­p vÃ o há»‡ thá»‘ng tá»‡p. Há»‡ thá»‘ng tá»‡p áº£o nÃ y yÃªu cáº§u trÃ¬nh Ä‘iá»u khiá»ƒn há»‡ thá»‘ng cá»¥ thá»ƒ cung cáº¥p giao diá»‡n cho há»‡ thá»‘ng tá»‡p.
## CÃ¡c tÃ­nh nÄƒng cá»§a há»‡ thá»‘ng tá»‡p Linux
* Trong Linux, há»‡ thá»‘ng tá»‡p táº¡o ra má»™t cáº¥u trÃºc cÃ¢y. Táº¥t cáº£ cÃ¡c tá»‡p Ä‘Æ°á»£c sáº¯p xáº¿p nhÆ° má»™t cÃ¡i cÃ¢y vÃ  cÃ¡c nhÃ¡nh cá»§a nÃ³. ThÆ° má»¥c trÃªn cÃ¹ng Ä‘Æ°á»£c gá»i lÃ  thÆ° má»¥c gá»‘c (/). Táº¥t cáº£ cÃ¡c thÆ° má»¥c khÃ¡c trong Linux cÃ³ thá»ƒ Ä‘Æ°á»£c truy cáº­p tá»« thÆ° má»¥c gá»‘c.

* Má»™t sá»‘ tÃ­nh nÄƒng chÃ­nh cá»§a há»‡ thá»‘ng tá»‡p Linux nhÆ° sau:

    * **Chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n**: Sá»­ dá»¥ng dáº¥u gáº¡ch chÃ©o (/) Ä‘á»ƒ chia cÃ¡c thÃ nh pháº§n. Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong /home/MyDocument/Work.

    * **PhÃ¢n vÃ¹ng, ThÆ° má»¥c vÃ  á»” Ä‘Ä©a**: Linux khÃ´ng sá»­ dá»¥ng kÃ½ tá»± á»• Ä‘Ä©a Ä‘á»ƒ tá»• chá»©c á»• Ä‘Ä©a nhÆ° Windows. Trong Linux,  khÃ´ng thá»ƒ biáº¿t liá»‡u chÃºng Ä‘ang Ä‘á»‹nh Ä‘á»‹a chá»‰ má»™t phÃ¢n vÃ¹ng, má»™t thiáº¿t bá»‹ máº¡ng hay má»™t thÆ° má»¥c "thÃ´ng thÆ°á»ng" vÃ  má»™t á»” Ä‘Ä©a.

    * **PhÃ¢n biá»‡t chá»¯ hoa chá»¯ thÆ°á»ng**: Há»‡ thá»‘ng tá»‡p Linux phÃ¢n biá»‡t chá»¯ hoa chá»¯ thÆ°á»ng. NÃ³ phÃ¢n biá»‡t giá»¯a tÃªn tá»‡p viáº¿t thÆ°á»ng vÃ  viáº¿t hoa. Cháº³ng háº¡n, cÃ³ sá»± khÃ¡c biá»‡t giá»¯a test.txt vÃ  Test.txt trong Linux. Quy táº¯c nÃ y cÅ©ng Ä‘Æ°á»£c Ã¡p dá»¥ng cho cÃ¡c thÆ° má»¥c vÃ  lá»‡nh Linux.

    * **Pháº§n má»Ÿ rá»™ng tá»‡p**: Trong Linux, tá»‡p cÃ³ thá»ƒ cÃ³ pháº§n má»Ÿ rá»™ng lÃ  '.txt', nhÆ°ng khÃ´ng nháº¥t thiáº¿t tá»‡p pháº£i cÃ³ pháº§n má»Ÿ rá»™ng tá»‡p. Trong khi lÃ m viá»‡c vá»›i Shell, nÃ³ táº¡o ra má»™t sá»‘ váº¥n Ä‘á» cho ngÆ°á»i má»›i báº¯t Ä‘áº§u Ä‘á»ƒ phÃ¢n biá»‡t giá»¯a cÃ¡c tá»‡p vÃ  thÆ° má»¥c. Náº¿u chÃºng ta sá»­ dá»¥ng trÃ¬nh quáº£n lÃ½ tá»‡p Ä‘á»“ há»a, nÃ³ tÆ°á»£ng trÆ°ng cho cÃ¡c tá»‡p vÃ  thÆ° má»¥c.

    * **Tá»‡p áº©n**: Linux phÃ¢n biá»‡t giá»¯a tá»‡p tiÃªu chuáº©n vÃ  tá»‡p áº©n, háº§u háº¿t cÃ¡c tá»‡p cáº¥u hÃ¬nh Ä‘Æ°á»£c áº©n trong Há»‡ Ä‘iá»u hÃ nh Linux. ThÃ´ng thÆ°á»ng, chÃºng ta khÃ´ng cáº§n truy cáº­p hoáº·c Ä‘á»c cÃ¡c tá»‡p áº©n. CÃ¡c tá»‡p áº©n trong Linux Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng dáº¥u cháº¥m (.) TrÆ°á»›c tÃªn tá»‡p (vÃ­ dá»¥: .ignore). Äá»ƒ truy cáº­p cÃ¡c tá»‡p, chÃºng ta cáº§n thay Ä‘á»•i cháº¿ Ä‘á»™ xem trong trÃ¬nh quáº£n lÃ½ tá»‡p hoáº·c cáº§n sá»­ dá»¥ng má»™t lá»‡nh cá»¥ thá»ƒ trong trÃ¬nh bao.
 ## CÃ¡c loáº¡i há»‡ thá»‘ng tá»‡p Linux
 * Khi chÃºng ta cÃ i Ä‘áº·t há»‡ Ä‘iá»u hÃ nh Linux, Linux cung cáº¥p nhiá»u há»‡ thá»‘ng tá»‡p nhÆ° Ext, Ext2, Ext3, Ext4, JFS, ReiserFS, XFS, btrfs vÃ  swap.
 ![image](https://user-images.githubusercontent.com/91528234/199150947-0ed029a9-49bb-4fbd-b38b-541b2e71dd5f.png)
 ### Ext, Ext2, Ext3 and Ext4 file system
 * Há»‡ thá»‘ng táº­p tin Ext lÃ  viáº¿t táº¯t cá»§a **Extended File System**. NÃ³ chá»§ yáº¿u Ä‘Æ°á»£c phÃ¡t triá»ƒn cho **MINIX OS**. Há»‡ thá»‘ng tá»‡p Ext lÃ  phiÃªn báº£n cÅ© hÆ¡n vÃ  khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng do má»™t sá»‘ háº¡n cháº¿.

* **Ext2** lÃ  há»‡ thá»‘ng tá»‡p Linux Ä‘áº§u tiÃªn cho phÃ©p quáº£n lÃ½ hai terabyte dá»¯ liá»‡u. Ext3 Ä‘Æ°á»£c phÃ¡t triá»ƒn thÃ´ng qua Ext2; nÃ³ lÃ  phiÃªn báº£n nÃ¢ng cáº¥p cá»§a Ext2 vÃ  cÃ³ kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch ngÆ°á»£c. Háº¡n cháº¿ lá»›n cá»§a Ext3 lÃ  khÃ´ng há»— trá»£ mÃ¡y chá»§ vÃ¬ há»‡ thá»‘ng tá»‡p nÃ y khÃ´ng há»— trá»£ khÃ´i phá»¥c tá»‡p vÃ  áº£nh chá»¥p nhanh Ä‘Ä©a.

* Há»‡ thá»‘ng tá»‡p **Ext4** lÃ  há»‡ thá»‘ng tá»‡p nhanh hÆ¡n trong sá»‘ táº¥t cáº£ cÃ¡c há»‡ thá»‘ng tá»‡p Ext. ÄÃ¢y lÃ  má»™t tÃ¹y chá»n ráº¥t tÆ°Æ¡ng thÃ­ch cho cÃ¡c Ä‘Ä©a SSD (á»• thá»ƒ ráº¯n) vÃ  nÃ³ lÃ  há»‡ thá»‘ng tá»‡p máº·c Ä‘á»‹nh trong báº£n phÃ¢n phá»‘i Linux.
### JFS File System
* **JFS** lÃ  viáº¿t táº¯t cá»§a **Journaled File System**, vÃ  nÃ³ Ä‘Æ°á»£c **IBM phÃ¡t triá»ƒn cho AIX Unix**. NÃ³ lÃ  má»™t thay tháº¿ cho há»‡ thá»‘ng tá»‡p Ext. NÃ³ cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng thay cho Ext4, nÆ¡i cáº§n sá»± á»•n Ä‘á»‹nh vá»›i Ã­t tÃ i nguyÃªn. NÃ³ lÃ  má»™t há»‡ thá»‘ng tá»‡p tiá»‡n dá»¥ng khi sá»©c máº¡nh cá»§a CPU bá»‹ háº¡n cháº¿.

### Há»‡ thá»‘ng tá»‡p ReiserFS

**ReiserFS** lÃ  má»™t giáº£i phÃ¡p thay tháº¿ cho há»‡ thá»‘ng tá»‡p Ext3. NÃ³ Ä‘Ã£ Ä‘Æ°á»£c cáº£i thiá»‡n hiá»‡u suáº¥t vÃ  cÃ¡c tÃ­nh nÄƒng nÃ¢ng cao. Trong thá»i gian trÆ°á»›c Ä‘Ã³, ReiserFS Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m há»‡ thá»‘ng tá»‡p máº·c Ä‘á»‹nh trong SUSE Linux, nhÆ°ng sau Ä‘Ã³ nÃ³ Ä‘Ã£ thay Ä‘á»•i má»™t sá»‘ chÃ­nh sÃ¡ch nÃªn SUSE quay trá»Ÿ láº¡i Ext3. Há»‡ thá»‘ng tá»‡p nÃ y há»— trá»£ Ä‘á»™ng pháº§n má»Ÿ rá»™ng tá»‡p, nhÆ°ng nÃ³ cÃ³ má»™t sá»‘ háº¡n cháº¿ vá» hiá»‡u suáº¥t.


### Há»‡ thá»‘ng tá»‡p XFS

* Há»‡ thá»‘ng tá»‡p **XFS** Ä‘Æ°á»£c coi lÃ  JFS tá»‘c Ä‘á»™ cao, Ä‘Æ°á»£c phÃ¡t triá»ƒn Ä‘á»ƒ xá»­ lÃ½ I/O song song. NASA váº«n Ä‘ang sá»­ dá»¥ng há»‡ thá»‘ng tá»‡p nÃ y vá»›i mÃ¡y chá»§ lÆ°u trá»¯ cao (mÃ¡y chá»§ 300+ Terabyte).

### Há»‡ thá»‘ng tá»‡p Btrfs

* **Btrfs** lÃ  viáº¿t táº¯t cá»§a há»‡ thá»‘ng tá»‡p B cÃ¢y. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‹u lá»—i, sá»­a chá»¯a há»‡ thá»‘ng, quáº£n trá»‹ vui váº», cáº¥u hÃ¬nh lÆ°u trá»¯ má»Ÿ rá»™ng vÃ  hÆ¡n tháº¿ ná»¯a. NÃ³ khÃ´ng pháº£i lÃ  má»™t phÃ¹ há»£p tá»‘t cho há»‡ thá»‘ng sáº£n xuáº¥t.

### HoÃ¡n Ä‘á»•i há»‡ thá»‘ng tá»‡p

Há»‡ thá»‘ng tá»‡p hoÃ¡n Ä‘á»•i Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n trang bá»™ nhá»› trong há»‡ Ä‘iá»u hÃ nh Linux trong cháº¿ Ä‘á»™ ngá»§ Ä‘Ã´ng cá»§a há»‡ thá»‘ng. Má»™t há»‡ thá»‘ng khÃ´ng bao giá» á»Ÿ tráº¡ng thÃ¡i ngá»§ Ä‘Ã´ng báº¯t buá»™c pháº£i cÃ³ khÃ´ng gian hoÃ¡n Ä‘á»•i báº±ng vá»›i kÃ­ch thÆ°á»›c RAM cá»§a nÃ³.

# Lá»‡nh Fsck trong linux (sá»­a chá»¯a há»‡ thá»‘ng táº­p tin)
* fsck (kiá»ƒm tra há»‡ thá»‘ng tá»‡p) lÃ  má»™t tiá»‡n Ã­ch dÃ²ng lá»‡nh cho phÃ©p báº¡n thá»±c hiá»‡n kiá»ƒm tra tÃ­nh nháº¥t quÃ¡n vÃ  sá»­a chá»¯a tÆ°Æ¡ng tÃ¡c trÃªn má»™t hoáº·c nhiá»u há»‡ thá»‘ng tá»‡p Linux. NÃ³ sá»­ dá»¥ng cÃ¡c chÆ°Æ¡ng trÃ¬nh dÃ nh riÃªng cho loáº¡i há»‡ thá»‘ng táº­p tin mÃ  nÃ³ kiá»ƒm tra.
## CÃ¡ch sá»­ dá»¥ng fsck
Lá»‡nh fsck cÃ³ dáº¡ng chung sau:
```
fsck
```
* Chá»‰ ngÆ°á»i dÃ¹ng root hoáº·c ngÆ°á»i dÃ¹ng cÃ³ quyá»n sudo cÃ³ thá»ƒ xÃ³a bá»™ Ä‘á»‡m.

* Khi khÃ´ng cÃ³ `FILESYSTEM` nÃ o Ä‘Æ°á»£c cung cáº¥p lÃ m Ä‘á»‘i sá»‘, fsck kiá»ƒm tra cÃ¡c thiáº¿t bá»‹ Ä‘Æ°á»£c liá»‡t kÃª trong tá»‡p fstab .

* KhÃ´ng bao giá» cháº¡y fsck trÃªn cÃ¡c phÃ¢n vÃ¹ng Ä‘Æ°á»£c gáº¯n vÃ¬ nÃ³ cÃ³ thá»ƒ lÃ m há»ng há»‡ thá»‘ng tá»‡p. TrÆ°á»›c khi thá»­ kiá»ƒm tra hoáº·c sá»­a chá»¯a cÃ¡c há»‡ thá»‘ng táº­p tin luÃ´n `unmount` nÃ³ trÆ°á»›c.

* Lá»‡nh fsck lÃ  má»™t trÃ¬nh bao bá»c cho cÃ¡c trÃ¬nh kiá»ƒm tra há»‡ thá»‘ng tá»‡p Linux khÃ¡c nhau ( fsck.* ) VÃ  cháº¥p nháº­n cÃ¡c tÃ¹y chá»n khÃ¡c nhau tÃ¹y thuá»™c vÃ o loáº¡i há»‡ thá»‘ng tá»‡p.

Kiá»ƒm tra cÃ¡c trang hÆ°á»›ng dáº«n Ä‘á»ƒ biáº¿t thÃªm thÃ´ng tin vá» má»™t trÃ¬nh kiá»ƒm tra cá»¥ thá»ƒ. VÃ­ dá»¥: Ä‘á»ƒ xem cÃ¡c tÃ¹y chá»n kháº£ dá»¥ng cho fsck.ext4 , hÃ£y nháº­p:
```
man fsck.ext4
```
## Khi nÃ o thÃ¬ dÃ¹ng fsck trong Linux
* CÃ³ nhiá»u tÃ¬nh huá»‘ng khÃ¡c nhau khi báº¡n muá»‘n cháº¡y fsck. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥:

* Há»‡ thá»‘ng khÃ´ng khá»Ÿi Ä‘á»™ng Ä‘Æ°á»£c.

* CÃ¡c tá»‡p trÃªn há»‡ thá»‘ng bá»‹ há»ng (thÆ°á»ng thÃ¬ báº¡n cÃ³ thá»ƒ tháº¥y lá»—i Ä‘áº§u vÃ o/Ä‘áº§u ra).

* á»” Ä‘Ä©a Ä‘Ã­nh kÃ¨m (bao gá»“m á»• Ä‘Ä©a flash/tháº» SD) khÃ´ng hoáº¡t Ä‘á»™ng nhÆ° mong Ä‘á»£i.
## CÃ¡c tÃ¹y chá»n cÃ³ sáºµn cá»§a fsck
* Lá»‡nh Fsck cáº§n Ä‘Æ°á»£c cháº¡y vá»›i cÃ¡c Ä‘áº·c quyá»n cá»§a superuser hoáº·c **root**. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ vá»›i cÃ¡c Ä‘á»‘i sá»‘ khÃ¡c nhau. Viá»‡c sá»­ dá»¥ng chÃºng tÃ¹y thuá»™c vÃ o trÆ°á»ng há»£p cá»¥ thá»ƒ cá»§a báº¡n. DÆ°á»›i Ä‘Ã¢y, báº¡n sáº½ tháº¥y má»™t sá»‘ tÃ¹y chá»n quan trá»ng hÆ¡n:

|COMMAND| ACTION |
| :---- | :---- |
-A | - ÄÆ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra táº¥t cáº£ cÃ¡c há»‡ thá»‘ng táº­p tin. Danh sÃ¡ch Ä‘Æ°á»£c láº¥y tá»« / etc / fstab.
-C | - Hiá»ƒn thá»‹ thanh tiáº¿n trÃ¬nh.
-l | - KhÃ³a thiáº¿t bá»‹ Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng cÃ³ chÆ°Æ¡ng trÃ¬nh nÃ o khÃ¡c cá»‘ gáº¯ng sá»­ dá»¥ng phÃ¢n vÃ¹ng trong quÃ¡ trÃ¬nh kiá»ƒm tra.
-M | - KhÃ´ng kiá»ƒm tra há»‡ thá»‘ng táº­p tin Ä‘Æ°á»£c gáº¯n káº¿t.
-N | - Chá»‰ hiá»ƒn thá»‹ nhá»¯ng gÃ¬ sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n - khÃ´ng cÃ³ thay Ä‘á»•i thá»±c táº¿ nÃ o Ä‘Æ°á»£c thá»±c hiá»‡n.
-P | - Náº¿u báº¡n muá»‘n kiá»ƒm tra song song cÃ¡c há»‡ thá»‘ng táº­p tin, bao gá»“m cáº£ root.
-R | - KhÃ´ng kiá»ƒm tra há»‡ thá»‘ng táº­p tin gá»‘c. Äiá»u nÃ y chá»‰ há»¯u Ã­ch vá»›i â€˜-Aâ€˜.
-r | - Cung cáº¥p sá»‘ liá»‡u thá»‘ng kÃª cho tá»«ng thiáº¿t bá»‹ Ä‘ang Ä‘Æ°á»£c kiá»ƒm tra.
-T | - KhÃ´ng hiá»ƒn thá»‹ tiÃªu Ä‘á».
-t | - Chá»‰ Ä‘á»‹nh riÃªng cÃ¡c loáº¡i há»‡ thá»‘ng tá»‡p Ä‘Æ°á»£c kiá»ƒm tra. CÃ¡c loáº¡i cÃ³ thá»ƒ lÃ  danh sÃ¡ch Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y.
-V | - Cung cáº¥p mÃ´ táº£ nhá»¯ng gÃ¬ Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n.
## CÃ¡ch cháº¡y fsck Ä‘á»ƒ sá»­a lá»—i há»‡ thá»‘ng tá»‡p Linux
* TrÆ°á»ng há»£p sá»­ dá»¥ng Ä‘Æ¡n giáº£n nháº¥t cá»§a lá»‡nh fsck lÃ  sá»­a chá»¯a má»™t há»‡ thá»‘ng tá»‡p ext3 hoáº·c ext4 khÃ´ng root bá»‹ há»ng.

* Ngáº¯t káº¿t ná»‘i thiáº¿t bá»‹:
```
sudo umount /dev/sda1
```
Cháº¡y fsck Ä‘á»ƒ sá»­a chá»¯a há»‡ thá»‘ng táº­p tin:
```
sudo fsck -p /dev/sda1
```
TÃ¹y chá»n `-p` yÃªu cáº§u fsck tá»± Ä‘á»™ng sá»­a chá»¯a má»i sá»± cá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c kháº¯c phá»¥c má»™t cÃ¡ch an toÃ n mÃ  khÃ´ng cáº§n sá»± can thiá»‡p cá»§a ngÆ°á»i dÃ¹ng.

Khi há»‡ thá»‘ng táº­p tin Ä‘Æ°á»£c sá»­a chá»¯a, gáº¯n káº¿t phÃ¢n vÃ¹ng:
```
sudo mount /dev/sda1
```
# Monitoring Disk
## Lá»‡nh df
* Lá»‡nh â€œdfâ€ viáº¿t táº¯t cá»§a â€œdisk filesystemâ€œ, nÃ³ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ láº¥y toÃ n bá»™ thÃ´ng tin vá» lÆ°á»£ng á»• cá»©ng kháº£ dá»¥ng vÃ  lÆ°á»£ng á»• cá»©ng Ä‘Ã£ dÃ¹ng cá»§a cÃ¡c file há»‡ thá»‘ng trÃªn linux. CÃ¡ch Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a lÃ  ta sá»­ dá»¥ng lá»‡nh `df`:

![image](https://user-images.githubusercontent.com/91528234/199157000-dbc89421-d653-4972-9431-1500436c6898.png)

* Trong Ä‘Ã³:

   * filesystem: tÃªn filesystem cÃ³ thá»ƒ trÃ¹ng vá»›i phÃ¢n vÃ¹ng Ä‘Ä©a.
   * 1K-blocks: Sá»‘ lÆ°á»£ng khá»‘i (block) cÃ³ trong filesystem cÃ³ kÃ­ch thÆ°á»›c 1Kb.
   * Used: Sá»‘ lÆ°á»£ng 1K-block Ä‘Æ°á»£c sá»­ dá»¥ng trong filesystem.
   * Available: Sá»‘ lÆ°á»£ng 1K-block Ä‘ang cÃ³ sáºµn.
   * Use%: Pháº§n trÄƒm Ä‘Ä©a Ä‘Ã£ sá»­ dá»¥ng trong filesystem.
   * Mounted on: NÆ¡i mount.
* Lá»‡nh `df` Ä‘Æ°á»£c Ä‘i kÃ¨m vá»›i má»™t sá»‘ tÃ¹y chá»n Ä‘á»ƒ hiá»ƒn thá»‹ ná»™i dung rÃµ rÃ ng vÃ  thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng hÆ¡n.
TÃ¹y chá»n `-h` cho ta má»™t cÃ¡i nhÃ¬n trá»±c quan hÆ¡n khi Ä‘á»c cÃ¡c thÃ´ng sá»‘ á»Ÿ cháº¿ Ä‘á»™ chi tiáº¿t : bytes, megabytes vÃ  gigabytes.

![image](https://user-images.githubusercontent.com/91528234/199157332-6daa82b5-b3ef-4f01-8993-e8cba2c45b42.png)
## Kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a vá»›i cÃ¡c trÆ°á»ng há»£p cá»¥ thá»ƒ
* Äá»ƒ kiá»ƒm tra space cá»§a má»™t Ä‘Ä©a/phÃ¢n vÃ¹ng cá»¥ thá»ƒ, báº¡n sá»­ dá»¥ng lá»‡nh df vá»›i cÃº phÃ¡p:
```
df <option> path
```
* Má»™t sá»‘ vÃ­ dá»¥:
     * Kiá»ƒm tra dung lÆ°á»£ng á»• Ä‘Ä©a phÃ¢n vÃ¹ng
     ![image](https://user-images.githubusercontent.com/91528234/199157667-92a505ad-f319-445a-abce-472026e42db6.png)
* Báº¡n cÃ³ thá»ƒ cá» `output` Ä‘i kÃ¨m lá»‡nh df:
```
df -h --output='field1', 'field2' /
```
      Kiá»ƒm tra kÃ­ch thÆ°á»›c vÃ  pháº§n trÄƒm Ä‘Ä©a Ä‘Ã£ sá»­ dá»¥ng, ta gÃµ lá»‡nh:
      ![image](https://user-images.githubusercontent.com/91528234/199157947-dd02236c-d3c5-4e2f-919f-cf5f735ac495.png)
## Lá»‡nh du
* du lÃ  má»™t cÃ´ng cá»¥ dÃ²ng lá»‡nh Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Linux, nháº±m bÃ¡o cÃ¡o dung lÆ°á»£ng á»• Ä‘Ä©a Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c thÆ° má»¥c vÃ  **file.du** lÃ  viáº¿t táº¯t cá»§a tá»« â€œdisk usageâ€. ÄÃ¢y lÃ  cÃ´ng cá»¥ chÃ­nh Ä‘á»ƒ phÃ¢n tÃ­ch khÃ´ng gian á»• Ä‘Ä©a trong dÃ²ng lá»‡nh.
```
du <option> <path|file>
du <option> <path1> <path2> <path3>  
```
* Kiá»ƒm tra dung lÆ°á»£ng cá»§a má»™t file cá»¥ thá»ƒ
VÃ­ dá»¥ Ä‘á»ƒ kiá»ƒm tra kÃ­ch thÆ°á»›c cá»§a má»™t file .bashrc, báº¡n cÃ³ thá»ƒ cháº¡y lá»‡nh:
![image](https://user-images.githubusercontent.com/91528234/199158729-4e8d56f6-ada1-49a2-8fef-75e0cef44589.png)
## Kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a Ä‘Ã£ sá»­ dá»¥ng cho cÃ¡c thÆ° má»¥c
* Báº¡n cÃ³ thá»ƒ kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a Ä‘Æ°á»£c sá»­ dá»¥ng cho thÆ° má»¥c báº±ng lá»‡nh du vá»›i tÃªn Ä‘Æ°á»ng dáº«n cá»¥ thá»ƒ. Tuy nhiÃªn trong má»™t vÃ i trÆ°á»ng há»£p báº¡n khÃ´ng muá»‘n nhÃ¬n tháº¥y output cá»§a táº¥t cáº£ file hoáº·c thÆ° má»¥c riÃªng láº», báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tÃ¹y chá»n `-shc`. VÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y, tÃ´i muá»‘n kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a Ä‘Ã£ sá»­ dá»¥ng cho thÆ° má»¥c /home hoáº·c /var/log.
![image](https://user-images.githubusercontent.com/91528234/199159211-4b39670c-9169-463c-8549-bbd019cc67c7.png)
* Ã nghÄ©a cá»§a cÃ¡c tÃ¹y chá»n:

   * `-s`: dÃ¹ng Ä‘á»ƒ tÃ³m táº¯t, nÃ³ sáº½ hiá»ƒn thá»‹ tá»•ng sá»‘ Ä‘Æ°á»ng dáº«n Ä‘Æ°á»£c cung cáº¥p thay vÃ¬ hiá»ƒn thá»‹ danh sÃ¡ch táº¥t cáº£ cÃ¡c tá»‡p vÃ  thÆ° má»¥c.
   * `-h`: Ä‘á»ƒ con ngÆ°á»i cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c, nÃ³ sáº½ hiá»ƒn thá»‹ káº¿t quáº£ vá»›i cÃ¡c Ä‘Æ¡n vá»‹.
   * `-c`: Ä‘á»‘i vá»›i tá»•ng sá»‘ lá»›n, náº¿u báº¡n chá»‰ Ä‘á»‹nh nhiá»u Ä‘Æ°á»ng dáº«n, nÃ³ sáº½ tá»•ng há»£p chÃºng Ä‘á»ƒ táº¡o ra tá»•ng sá»‘ lá»›n cho chÃºng.
   # Táº¡o file Systems
   
* Lá»‡nh mkfs xÃ¢y dá»±ng há»‡ thá»‘ng tá»‡p trÃªn thiáº¿t bá»‹ khá»‘i:
```
# mkfs [option] device
```
* mkfs lÃ  giao diá»‡n ngÆ°á»i dÃ¹ng cho cÃ¡c tiá»‡n Ã­ch trÃ¬nh táº¡o trong /sbin cháº³ng háº¡n nhÆ° **mkfs.ext4**. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh mkfs vá»›i tÃ¹y chá»n `-t` fstype hoáº·c tiá»‡n Ã­ch trÃ¬nh táº¡o Ä‘á»ƒ chá»‰ Ä‘á»‹nh loáº¡i há»‡ thá»‘ng tá»‡p cáº§n xÃ¢y dá»±ng. VÃ­ dá»¥: cÃ¡c lá»‡nh sau lÃ  cÃ¡c cÃ¡ch tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»ƒ táº¡o há»‡ thá»‘ng tá»‡p ext4 vá»›i nhÃ£n Dá»± Ã¡n trÃªn thiáº¿t bá»‹ /dev/sdb1:
```
# mkfs -t ext4 -L Projects /dev/sdb1
# mkfs.ext4 -L Projects /dev/sdb1
```
* vÃ  xem file Ä‘Ã£ Ä‘Æ°á»£c khá»Ÿi táº¡o chÆ°a vá»›i lá»‡nh
```
lsblk
```
# Mounting and Unmounting Filesystems
* Äá»ƒ truy cáº­p ná»™i dung cá»§a há»‡ thá»‘ng tá»‡p, báº¡n pháº£i gáº¯n thiáº¿t bá»‹ khá»‘i cá»§a nÃ³ vÃ o má»™t Ä‘iá»ƒm gáº¯n káº¿t trong há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh mkdir Ä‘á»ƒ táº¡o má»™t thÆ° má»¥c Ä‘á»ƒ sá»­ dá»¥ng lÃ m Ä‘iá»ƒm gáº¯n káº¿t, vÃ­ dá»¥:
```
# mkdir /var/project
```

* Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng má»™t thÆ° má»¥c hiá»‡n cÃ³ lÃ m Ä‘iá»ƒm gáº¯n káº¿t, nhÆ°ng ná»™i dung cá»§a nÃ³ sáº½ bá»‹ áº©n cho Ä‘áº¿n khi báº¡n ngáº¯t káº¿t ná»‘i há»‡ thá»‘ng tá»‡p cÆ¡ báº£n.

* Lá»‡nh mount sáº½ gáº¯n thiáº¿t bá»‹ chá»©a há»‡ thá»‘ng tá»‡p vÃ o Ä‘iá»ƒm mount:
```
# mount [options] device mount_point 
```

* Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh thiáº¿t bá»‹ theo tÃªn, UUID hoáº·c nhÃ£n cá»§a nÃ³. VÃ­ dá»¥: cÃ¡c lá»‡nh sau lÃ  cÃ¡c cÃ¡ch tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»ƒ gáº¯n há»‡ thá»‘ng tá»‡p trÃªn thiáº¿t bá»‹ khá»‘i /dev/sdb1:
```
# mount /dev/sdb1/var/project
# mount LABEL = "projects" /var/project
```

* Náº¿u báº¡n khÃ´ng chá»‰ Ä‘á»‹nh báº¥t ká»³ Ä‘á»‘i sá»‘ nÃ o, mount sáº½ hiá»ƒn thá»‹ táº¥t cáº£ cÃ¡c há»‡ thá»‘ng tá»‡p mÃ  há»‡ thá»‘ng hiá»‡n Ä‘Ã£ gáº¯n káº¿t, vÃ­ dá»¥:
```
# mout
/dev/mapper/vg_host01-lv_root on / type ext4 (rw)
...
```
* Trong vÃ­ dá»¥ nÃ y, LVM logic volume/dev/mapper/ vg_host01-lv_root Ä‘Æ°á»£c gáº¯n trÃªn /. Loáº¡i há»‡ thá»‘ng tá»‡p lÃ  ext4 vÃ  Ä‘Æ°á»£c gáº¯n cho cáº£ viá»‡c Ä‘á»c vÃ  ghi. (Báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng lá»‡nh cat /proc/mounts Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin vá» há»‡ thá»‘ng tá»‡p Ä‘Æ°á»£c gáº¯n káº¿t.)

Lá»‡nh df hiá»ƒn thá»‹ thÃ´ng tin vá» khÃ´ng gian cÃ²n láº¡i trong nhÃ  trÃªn cÃ¡c há»‡ thá»‘ng tá»‡p Ä‘Æ°á»£c gáº¯n káº¿t, vÃ­ dá»¥:
```
# df -h
Filesystem                     Size  Used Avail Use% Mounted on
/dev/mapper/vg_host01-lv_root  36G   12G   22G  36% /
...
```

* Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tÃ¹y chá»n -B (bind) cho lá»‡nh mount Ä‘á»ƒ gáº¯n thiáº¿t bá»‹ khá»‘i táº¡i nhiá»u Ä‘iá»ƒm mount. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘áº¿m láº¡i má»™t pháº§n cá»§a há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c, khÃ´ng cáº§n pháº£i lÃ  má»™t há»‡ thá»‘ng tá»‡p hoÃ n chá»‰nh, á»Ÿ má»™t nÆ¡i khÃ¡c. VÃ­ dá»¥, lá»‡nh sau mounts /var/project/project1 on/mnt:
```
# mount -B /var/projects/project1 /mnt
```
* Má»—i há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c hoáº¡t Ä‘á»™ng nhÆ° má»™t báº£n sao cá»§a há»‡ thá»‘ng phÃ¢n cáº¥p khÃ¡c. CÃ¡c tá»‡p giá»‘ng nhau Ä‘á»u cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c á»Ÿ cáº£ hai vá»‹ trÃ­, máº·c dÃ¹ báº¥t ká»³ sá»‘ lÆ°á»£ng con nÃ o khÃ´ng Ä‘Æ°á»£c sao chÃ©p. Nhá»¯ng gÆ°Æ¡ng nÃ y khÃ´ng cung cáº¥p dá»± phÃ²ng dá»¯ liá»‡u.

* Báº¡n cÅ©ng cÃ³ thá»ƒ gáº¯n káº¿t má»™t tá»‡p trÃªn má»™t tá»‡p khÃ¡c, vÃ­ dá»¥:
```
# touch /mnt/foo

# mount -B /etc/hosts/mnt/foo
```
* Trong vÃ­ dá»¥ nÃ y, /etc/hosts vÃ  /mnt/foo Ä‘áº¡i diá»‡n cho cÃ¹ng má»™t tá»‡p. KhÃ´ng thá»ƒ truy cáº­p tá»‡p hiá»‡n cÃ³ hoáº¡t Ä‘á»™ng nhÆ° má»™t Ä‘iá»ƒm gáº¯n káº¿t cho Ä‘áº¿n khi báº¡n ngáº¯t káº¿t ná»‘i tá»‡p bÃªn trÃªn.

TÃ¹y chá»n `-B` khÃ´ng Ä‘Ã­nh kÃ¨m Ä‘á»‡ quy báº¥t ká»³ tÃ i khoáº£n con nÃ o bÃªn dÆ°á»›i há»‡ thá»‘ng phÃ¢n cáº¥p thÆ° má»¥c. Äá»ƒ bao gá»“m cÃ¡c sá»‘ lÆ°á»£ng con trong nhÃ¢n báº£n, hÃ£y sá»­ dá»¥ng tÃ¹y chá»n `-R` (liÃªn káº¿t Ä‘á»‡ quy) Ä‘á»ƒ thay tháº¿.

Khi báº¡n sá»­ dá»¥ng `-B` hoáº·c `-R`, cÃ¡c tÃ¹y chá»n gáº¯n káº¿t há»‡ thá»‘ng tá»‡p váº«n giá»‘ng nhÆ° cÃ¡c tÃ¹y chá»n cho Ä‘iá»ƒm gáº¯n káº¿t ban Ä‘áº§u. Äá»ƒ sá»­a Ä‘á»•i cÃ¡c tÃ¹y chá»n gáº¯n káº¿t, hÃ£y sá»­ dá»¥ng má»™t lá»‡nh remount riÃªng, vÃ­ dá»¥:
```
# mount -o remount,ro /mnt/foo
```
* Äá»ƒ ngáº¯t káº¿t ná»‘i há»‡ thá»‘ng tá»‡p, hÃ£y sá»­ dá»¥ng lá»‡nh umount, vÃ­ dá»¥:
```
# umount /var/project
```
# Partitioning Disks( PhÃ¢n vÃ¹n á»• Ä‘Ä©a)
* PhÃ¢n vÃ¹ng Ä‘Ä©a lÃ  quÃ¡ trÃ¬nh chia Ä‘Ä©a thÃ nh má»™t hoáº·c nhiá»u vÃ¹ng Ä‘Æ°á»£c gá»i lÃ  phÃ¢n vÃ¹ng. Báº£ng phÃ¢n vÃ¹ng náº±m trong khu vá»±c Ä‘áº§u tiÃªn cá»§a Ä‘Ä©a vÃ  lÆ°u trá»¯ thÃ´ng tin vá» kÃ­ch thÆ°á»›c vÃ  vá»‹ trÃ­ cá»§a cÃ¡c phÃ¢n vÃ¹ng Ä‘Ã£ táº¡o. NÃ³i cÃ¡ch khÃ¡c, phÃ¢n vÃ¹ng Ä‘Ä©a cho phÃ©p chia má»™t á»• Ä‘Ä©a váº­t lÃ½ thÃ nh cÃ¡c á»• Ä‘Ä©a logic nhá» hÆ¡n Ä‘Æ°á»£c gá»i lÃ  á»• Ä‘Ä©a. Äá»‘i vá»›i má»™t há»‡ Ä‘iá»u hÃ nh, cÃ¡c á»• Ä‘Ä©a nÃ y hoÃ n toÃ n riÃªng biá»‡t, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c trÃªn má»™t á»• Ä‘Ä©a mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c á»• Ä‘Ä©a khÃ¡c.

* Háº§u háº¿t ngÆ°á»i dÃ¹ng sáº½ khÃ´ng bao giá» gáº·p pháº£i nhu cáº§u phÃ¢n vÃ¹ng Ä‘Ä©a, nhÆ°ng phÃ¢n vÃ¹ng Ä‘Ä©a cÃ³ thá»ƒ há»¯u Ã­ch trong má»™t sá»‘ trÆ°á»ng há»£p.

   * Má»™t á»• cá»©ng má»›i thá»±c táº¿ khÃ´ng thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c trá»« khi nÃ³ Ä‘Æ°á»£c phÃ¢n vÃ¹ng Ä‘á»ƒ lÆ°u dá»¯ liá»‡u.

   * CÃ¡c phÃ¢n vÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»• chá»©c dá»¯ liá»‡u theo kiá»ƒu cá»§a chÃºng. VÃ­ dá»¥: báº¡n cÃ³ thá»ƒ cÃ³ má»™t phÃ¢n vÃ¹ng lÆ°u trá»¯ táº¥t cáº£ cÃ¡c tÃ i liá»‡u cá»§a báº¡n vÃ  má»™t phÃ¢n vÃ¹ng khÃ¡c lÆ°u trá»¯ táº¥t cáº£ cÃ¡c tá»‡p nháº¡c cá»§a báº¡n.

   * Windows cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c cÃ i Ä‘áº·t láº¡i mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c chÆ°Æ¡ng trÃ¬nh Ä‘Ã£ cÃ i Ä‘áº·t vÃ¬ cÃ¡c tá»‡p khá»Ÿi Ä‘á»™ng Ä‘Æ°á»£c lÆ°u trá»¯ an toÃ n trong phÃ¢n vÃ¹ng há»‡ thá»‘ng. PhÃ¢n vÃ¹ng há»‡ thá»‘ng Ä‘Æ°á»£c giá»¯ riÃªng biá»‡t vá»›i pháº§n cÃ²n láº¡i cá»§a cÃ¡c phÃ¢n vÃ¹ng lÆ°u trá»¯ cÃ¡c á»©ng dá»¥ng Ä‘Ã£ cÃ i Ä‘áº·t.
   * Náº¿u báº¡n muá»‘n sao lÆ°u má»™t táº­p há»£p con dá»¯ liá»‡u nháº¥t Ä‘á»‹nh, phÃ¢n vÃ¹ng mÃ  nÃ³ Ä‘Æ°á»£c lÆ°u trá»¯ cÃ³ thá»ƒ Ä‘Æ°á»£c sao lÆ°u thay vÃ¬ toÃ n bá»™ á»• Ä‘Ä©a váº­t lÃ½.
   * CÃ¡c phÃ¢n vÃ¹ng giÃºp cho viá»‡c khÃ´i phá»¥c dá»¯ liá»‡u trá»Ÿ nÃªn thuáº­n tiá»‡n vÃ  hiá»‡u quáº£.
      
 ## PhÃ¢n quyá»n vá»›i lá»‡nh fdisk
 fdisk Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng báº±ng cÃ¡ch gÃµ thiáº¿t bá»‹ fdisk (vá»›i tÆ° cÃ¡ch gá»‘c) táº¡i dáº¥u nháº¯c lá»‡nh. thiáº¿t bá»‹ cÃ³ thá»ƒ giá»‘ng nhÆ° / dev / hda hoáº·c / dev / sda (xem Pháº§n 2.1.1). CÃ¡c lá»‡nh fdisk cÆ¡ báº£n báº¡n cáº§n lÃ :

|COMMAND| ACTION |
| :---- | :---- |
p | in báº£ng phÃ¢n vÃ¹ng
n | táº¡o má»™t phÃ¢n vÃ¹ng má»›i
d | xÃ³a má»™t phÃ¢n vÃ¹ng
q | thoÃ¡t mÃ  khÃ´ng lÆ°u cÃ¡c thay Ä‘á»•i
w | viáº¿t báº£ng phÃ¢n vÃ¹ng má»›i vÃ  thoÃ¡t
# RAID
* RAID lÃ  chá»¯ viáº¿t táº¯t cá»§a Redundant Array of Independent Disks. Ban Ä‘áº§u, RAID Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t giáº£i phÃ¡p phÃ²ng há»™ vÃ¬ nÃ³ cho phÃ©p ghi dá»¯ liá»‡u lÃªn nhiá»u Ä‘Ä©a cá»©ng cÃ¹ng lÃºc. Vá» sau, RAID Ä‘Ã£ cÃ³ nhiá»u biáº¿n thá»ƒ cho phÃ©p khÃ´ng chá»‰ Ä‘áº£m báº£o an toÃ n dá»¯ liá»‡u mÃ  cÃ²n giÃºp gia tÄƒng Ä‘Ã¡ng ká»ƒ tá»‘c Ä‘á»™ truy xuáº¥t dá»¯ liá»‡u tá»« Ä‘Ä©a cá»©ng. DÆ°á»›i Ä‘Ã¢y lÃ  nÄƒm loáº¡i RAID Ä‘Æ°á»£c dÃ¹ng phá»• biáº¿n:

* CÃ³ thá»ƒ hiá»ƒu nhanh vá» RAID qua thÃ´ng tin dÆ°á»›i Ä‘Ã¢y:
   * RAID chá»‰ nÃªn lÃ m viá»‡c vá»›i cÃ¡c loáº¡i á»• cá»©ng dung lÆ°á»£ng báº±ng nhau.
   * Sá»­ dá»¥ng RAID sáº½ tá»‘n sá»‘ lÆ°á»£ng á»• nhiá»u hÆ¡n bÃ¬nh thÆ°á»ng, nhÆ°ng Ä‘á»•i láº¡i lÃ  dá»¯ liá»‡u sáº½ an toÃ n hÆ¡n.
   * RAID cÃ³ thá»ƒ dÃ¹ng cho báº¥t ká»³ há»‡ Ä‘iá»u hÃ nh nÃ o, Window, MAC OS X, Linuxâ€¦vv
   * RAID 0 báº±ng tá»•ng dung lÆ°á»£ng cÃ¡c á»• cá»™ng láº¡i.
   * RAID 1 chá»‰ duy trÃ¬ dung lÆ°á»£ng 1 á»•.
   * RAID 5 sáº½ cÃ³ dung lÆ°á»£ng Ã­t hÆ¡n 1 á»• (5 á»• dÃ¹ng raid 5 sáº½ cÃ³ dung lÆ°á»£ng 4 á»•).
   * RAID 10 sáº½ chá»‰ táº¡o Ä‘Æ°á»£c khi sá»‘ á»• lÃ  cháºµn, pháº£i cÃ³ tá»‘i thiá»ƒu tá»« Ã´ á»• trá»Ÿ lÃªn. Dung lÆ°á»£ng báº±ng tá»•ng sá»‘ á»• chia Ä‘Ã´i (10 á»• thÃ¬ dung lÆ°á»£ng sá»­ dá»¥ng lÃ  5 á»•).
   ## RAID 0
 ![image](https://user-images.githubusercontent.com/91528234/199191680-8cc51e6b-bcf1-4a2a-889f-402543bbdd9a.png)
 * ÄÃ¢y lÃ  dáº¡ng RAID Ä‘ang Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng Æ°a thÃ­ch do kháº£ nÄƒng nÃ¢ng cao hiá»‡u suáº¥t trao Ä‘á»•i dá»¯ liá»‡u cá»§a Ä‘Ä©a cá»©ng. ÄÃ²i há»i tá»‘i thiá»ƒu hai Ä‘Ä©a cá»©ng, RAID 0 cho phÃ©p mÃ¡y tÃ­nh ghi dá»¯ liá»‡u lÃªn chÃºng theo má»™t phÆ°Æ¡ng thá»©c Ä‘áº·c biá»‡t Ä‘Æ°á»£c gá»i lÃ  Striping. VÃ­ dá»¥ báº¡n cÃ³ 8 Ä‘oáº¡n dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ tá»« 1 Ä‘áº¿n 8, cÃ¡c Ä‘oáº¡n Ä‘Ã¡nh sá»‘ láº» (1,3,5,7) sáº½ Ä‘Æ°á»£c ghi lÃªn Ä‘Ä©a cá»©ng Ä‘áº§u tiÃªn vÃ  cÃ¡c Ä‘oáº¡n Ä‘Ã¡nh sá»‘ cháºµn (2,4,6,8) sáº½ Ä‘Æ°á»£c ghi lÃªn Ä‘Ä©a thá»© hai. Äá»ƒ Ä‘Æ¡n giáº£n hÆ¡n, báº¡n cÃ³ thá»ƒ hÃ¬nh dung mÃ¬nh cÃ³ 100MB dá»¯ liá»‡u vÃ  thay vÃ¬ dá»“n 100MB vÃ o má»™t Ä‘Ä©a cá»©ng duy nháº¥t, RAID 0 sáº½ giÃºp dá»“n 50MB vÃ o má»—i Ä‘Ä©a cá»©ng riÃªng giÃºp giáº£m má»™t ná»­a thá»i gian lÃ m viá»‡c theo lÃ½ thuyáº¿t. Tá»« Ä‘Ã³ báº¡n cÃ³ thá»ƒ dá»… dÃ ng suy ra náº¿u cÃ³ 4, 8 hay nhiá»u Ä‘Ä©a cá»©ng hÆ¡n ná»¯a thÃ¬ tá»‘c Ä‘á»™ sáº½ cÃ ng cao hÆ¡n. Tuy nghe cÃ³ váº» háº¥p dáº«n nhÆ°ng trÃªn thá»±c táº¿, RAID 0 váº«n áº©n chá»©a nguy cÆ¡ máº¥t dá»¯ liá»‡u. NguyÃªn nhÃ¢n chÃ­nh láº¡i náº±m á»Ÿ cÃ¡ch ghi thÃ´ng tin xÃ© láº» vÃ¬ nhÆ° váº­y dá»¯ liá»‡u khÃ´ng náº±m hoÃ n toÃ n á»Ÿ má»™t Ä‘Ä©a cá»©ng nÃ o vÃ  má»—i khi cáº§n truy xuáº¥t thÃ´ng tin (vÃ­ dá»¥ má»™t file nÃ o Ä‘Ã³), mÃ¡y tÃ­nh sáº½ pháº£i tá»•ng há»£p tá»« cÃ¡c Ä‘Ä©a cá»©ng. Náº¿u má»™t Ä‘Ä©a cá»©ng gáº·p trá»¥c tráº·c thÃ¬ thÃ´ng tin (file) Ä‘Ã³ coi nhÆ° khÃ´ng thá»ƒ Ä‘á»c Ä‘Æ°á»£c vÃ  máº¥t luÃ´n. Tháº­t may máº¯n lÃ  vá»›i cÃ´ng nghá»‡ hiá»‡n Ä‘áº¡i, sáº£n pháº©m pháº§n cá»©ng khÃ¡ bá»n nÃªn nhá»¯ng trÆ°á»ng há»£p máº¥t dá»¯ liá»‡u nhÆ° váº­y xáº£y ra khÃ´ng nhiá»u.

* CÃ³ thá»ƒ tháº¥y RAID 0 thá»±c sá»± thÃ­ch há»£p cho nhá»¯ng ngÆ°á»i dÃ¹ng cáº§n truy cáº­p nhanh khá»‘i lÆ°á»£ng dá»¯ liá»‡u lá»›n, vÃ­ dá»¥ cÃ¡c game thá»§ hoáº·c nhá»¯ng ngÆ°á»i chuyÃªn lÃ m Ä‘á»“ hoáº¡, video sá»‘.
## RAID 1
![image](https://user-images.githubusercontent.com/91528234/199192151-75d0847a-aea0-44fd-b86c-c7ffa2534265.png)
* ÄÃ¢y lÃ  dáº¡ng RAID cÆ¡ báº£n nháº¥t cÃ³ kháº£ nÄƒng Ä‘áº£m báº£o an toÃ n dá»¯ liá»‡u. CÅ©ng giá»‘ng nhÆ° RAID 0, RAID 1 Ä‘Ã²i há»i Ã­t nháº¥t hai Ä‘Ä©a cá»©ng Ä‘á»ƒ lÃ m viá»‡c. Dá»¯ liá»‡u Ä‘Æ°á»£c ghi vÃ o 2 á»• giá»‘ng há»‡t nhau (Mirroring). Trong trÆ°á»ng há»£p má»™t á»• bá»‹ trá»¥c tráº·c, á»• cÃ²n láº¡i sáº½ tiáº¿p tá»¥c hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng. Báº¡n cÃ³ thá»ƒ thay tháº¿ á»• Ä‘Ä©a bá»‹ há»ng mÃ  khÃ´ng pháº£i lo láº¯ng Ä‘áº¿n váº¥n Ä‘á» thÃ´ng tin tháº¥t láº¡c. Äá»‘i vá»›i RAID 1, hiá»‡u nÄƒng khÃ´ng pháº£i lÃ  yáº¿u tá»‘ hÃ ng Ä‘áº§u nÃªn cháº³ng cÃ³ gÃ¬ ngáº¡c nhiÃªn náº¿u nÃ³ khÃ´ng pháº£i lÃ  lá»±a chá»n sá»‘ má»™t cho nhá»¯ng ngÆ°á»i say mÃª tá»‘c Ä‘á»™. Tuy nhiÃªn Ä‘á»‘i vá»›i nhá»¯ng nhÃ  quáº£n trá»‹ máº¡ng hoáº·c nhá»¯ng ai pháº£i quáº£n lÃ½ nhiá»u thÃ´ng tin quan trá»ng thÃ¬ há»‡ thá»‘ng RAID 1 lÃ  thá»© khÃ´ng thá»ƒ thiáº¿u. Dung lÆ°á»£ng cuá»‘i cÃ¹ng cá»§a há»‡ thá»‘ng RAID 1 báº±ng dung lÆ°á»£ng cá»§a á»• Ä‘Æ¡n (hai á»• 80GB cháº¡y RAID 1 sáº½ cho há»‡ thá»‘ng nhÃ¬n tháº¥y duy nháº¥t má»™t á»• RAID 80GB).
# RAID 5
![image](https://user-images.githubusercontent.com/91528234/199192289-bdf767fa-7695-4924-bd37-0e6873c99226.png)
* y cÃ³ láº½ lÃ  dáº¡ng RAID máº¡nh máº½ nháº¥t cho ngÆ°á»i dÃ¹ng vÄƒn phÃ²ng vÃ  gia Ä‘Ã¬nh vá»›i 3 hoáº·c 5 Ä‘Ä©a cá»©ng riÃªng biá»‡t. Dá»¯ liá»‡u vÃ  báº£n sao lÆ°u Ä‘Æ°á»£c chia lÃªn táº¥t cáº£ cÃ¡c á»• cá»©ng. NguyÃªn táº¯c nÃ y khÃ¡ rá»‘i ráº¯m. ChÃºng ta quay trá»Ÿ láº¡i vÃ­ dá»¥ vá» 8 Ä‘oáº¡n dá»¯ liá»‡u (1-8) vÃ  giá» Ä‘Ã¢y lÃ  3 á»• Ä‘Ä©a cá»©ng. Äoáº¡n dá»¯ liá»‡u sá»‘ 1 vÃ  sá»‘ 2 sáº½ Ä‘Æ°á»£c ghi vÃ o á»• Ä‘Ä©a 1 vÃ  2 riÃªng ráº½, Ä‘oáº¡n sao lÆ°u cá»§a chÃºng Ä‘Æ°á»£c ghi vÃ o á»• cá»©ng 3. Äoáº¡n sá»‘ 3 vÃ  4 Ä‘Æ°á»£c ghi vÃ o á»• 1 vÃ  3 vá»›i Ä‘oáº¡n sao lÆ°u tÆ°Æ¡ng á»©ng ghi vÃ o á»• Ä‘Ä©a 2. Äoáº¡n sá»‘ 5, 6 ghi vÃ o á»• Ä‘Ä©a 2 vÃ  3, cÃ²n Ä‘oáº¡n sao lÆ°u Ä‘Æ°á»£c ghi vÃ o á»• Ä‘Ä©a 1 vÃ  sau Ä‘Ã³ trÃ¬nh tá»± nÃ y láº·p láº¡i, Ä‘oáº¡n sá»‘ 7,8 Ä‘Æ°á»£c ghi vÃ o á»• 1, 2 vÃ  Ä‘oáº¡n sao lÆ°u ghi vÃ o á»• 3 nhÆ° ban Ä‘áº§u. NhÆ° váº­y RAID 5 vá»«a Ä‘áº£m báº£o tá»‘c Ä‘á»™ cÃ³ cáº£i thiá»‡n, vá»«a giá»¯ Ä‘Æ°á»£c tÃ­nh an toÃ n cao. Dung lÆ°á»£ng Ä‘Ä©a cá»©ng cuá»‘i cÃ¹ng báº±ng tá»•ng dung lÆ°á»£ng Ä‘Ä©a sá»­ dá»¥ng trá»« Ä‘i má»™t á»•. Tá»©c lÃ  náº¿u báº¡n dÃ¹ng 3 á»• 80GB thÃ¬ dung lÆ°á»£ng cuá»‘i cÃ¹ng sáº½ lÃ  160GB.
## RAID 10
*  bao giá» báº¡n ao Æ°á»›c má»™t há»‡ thá»‘ng lÆ°u trá»¯ nhanh nháº¹n nhÆ° RAID 0, an toÃ n nhÆ° RAID 1 hay chÆ°a? Cháº¯c cháº¯n lÃ  cÃ³ vÃ  hiá»ƒn nhiÃªn Æ°á»›c muá»‘n Ä‘Ã³ khÃ´ng chá»‰ cá»§a riÃªng báº¡n. ChÃ­nh vÃ¬ tháº¿ mÃ  há»‡ thá»‘ng RAID káº¿t há»£p 0+1 Ä‘Ã£ ra Ä‘á»i, tá»•ng há»£p Æ°u Ä‘iá»ƒm cá»§a cáº£ hai â€œÄ‘Ã n anhâ€. Tuy nhiÃªn chi phÃ­ cho má»™t há»‡ thá»‘ng kiá»ƒu nÃ y khÃ¡ Ä‘áº¯t, báº¡n sáº½ cáº§n tá»‘i thiá»ƒu 4 Ä‘Ä©a cá»©ng Ä‘á»ƒ cháº¡y RAID 0+1. Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c ghi Ä‘á»“ng thá»i lÃªn 4 Ä‘Ä©a cá»©ng vá»›i 2 á»• dáº¡ng Striping tÄƒng tá»‘c vÃ  2 á»• dáº¡ng Mirroring sao lÆ°u. 4 á»• Ä‘Ä©a nÃ y pháº£i giá»‘ng há»‡t nhau vÃ  khi Ä‘Æ°a vÃ o há»‡ thá»‘ng RAID 0+1, dung lÆ°á»£ng cuá»‘i cÃ¹ng sáº½ báº±ng Â½ tá»•ng dung lÆ°á»£ng 4 á»•, vÃ­ dá»¥ báº¡n cháº¡y 4 á»• 80GB thÃ¬ lÆ°á»£ng dá»¯ liá»‡u â€œtháº¥y Ä‘Æ°á»£câ€ lÃ  (4*80)/2 = 160GB

## Lá»±a chá»n theo nhu cáº§u
![image](https://user-images.githubusercontent.com/91528234/199192971-06133a58-1a9e-4411-8fe3-81c98f7fab81.png)

## Lá»‡nh mdadm
* Tiá»‡n Ã­ch mdadm cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o vÃ  quáº£n lÃ½ cÃ¡c máº£ng lÆ°u trá»¯ báº±ng kháº£ nÄƒng RAID pháº§n má»m cá»§a Linux. Quáº£n trá»‹ viÃªn cÃ³ kháº£ nÄƒng linh hoáº¡t cao trong viá»‡c phá»‘i há»£p cÃ¡c thiáº¿t bá»‹ lÆ°u trá»¯ riÃªng láº» cá»§a há» vÃ  táº¡o ra cÃ¡c thiáº¿t bá»‹ lÆ°u trá»¯ há»£p lÃ½ cÃ³ hiá»‡u suáº¥t cao hÆ¡n hoáº·c cÃ¡c Ä‘áº·c Ä‘iá»ƒm dá»± phÃ²ng.
### VD vá» táº¡o RAID0
#### BÆ°á»›c 1: Cáº­p nháº­t há»‡ thá»‘ng vÃ  cÃ i Ä‘áº·t mdadm Ä‘á»ƒ quáº£n lÃ½ RAID

Äá»ƒ thiáº¿t láº­p RAID0 trÃªn há»‡ Ä‘iá»u hÃ nh Linux chÃºng ta cáº§n thá»±c hiá»‡n cáº­p nháº­t (update) há»‡ thá»‘ng vÃ  cÃ i Ä‘áº·t gÃ³i `mdadm`.

#### BÆ°á»›c 2: Kiá»ƒm tra thÃ´ng tin á»• Ä‘Ä©a trÃªn mÃ¡y:

* TrÆ°á»›c khi táº¡o RAID0, cáº§n Ä‘áº£m báº£o cÃ³ Ã­t nháº¥t hai á»• Ä‘Ä©a cá»©ng cháº¡y lá»‡nh sau Ä‘á»ƒ kiá»ƒm tra:
```
[root@localhost ~]# fdisk -l |grep sd
Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors
/dev/sda1   *        2048     2099199     1048576   83  Linux
/dev/sda2         2099200    41943039    19921920   8e  Linux LVM
Disk /dev/sdb: 10.7 GB, 10737418240 bytes, 20971520 sectors
Disk /dev/sdc: 10.7 GB, 10737418240 bytes, 20971520 sectors
```
* Qua lá»‡nh kiá»ƒm tra trÃªn chÃºng ta tháº¥y cÃ³ 2 Ä‘Ä©a cá»©ng má»›i Ä‘Æ°á»£c phÃ¡t hiá»‡n, bÃ¢y giá» chÃºng ta thá»±c hiá»‡n kiá»ƒm tra xem cÃ¡c á»• cá»©ng cÃ³ sá»­ dá»¥ng RAID nÃ o chÆ°a báº±ng lá»‡nh mdadm cÃ¹ng vá»›i tÃ¹y chá»n --examine nhÆ° bÃªn dÆ°á»›i.
```
[root@localhost ~]# mdadm --examine /dev/sd[b-c]
mdadm: No md superblock detected on /dev/sdb.
mdadm: No md superblock detected on /dev/sdc.
```

* Káº¿t trÃªn tráº£ vá» cho chÃºng ta biáº¿t ráº±ng khÃ´ng cÃ³ RAID nÃ o Ä‘Æ°á»£c Ã¡p dá»¥ng cho hai á»• sdb vÃ  sdc.

#### BÆ°á»›c 3: Táº¡o phÃ¢n vÃ¹ng Ä‘Ä©a cá»©ng

* Thá»±c hiá»‡n táº¡o phÃ¢n vÃ¹ng trÃªn Ä‘Ä©a cÃ³ tÃªn lÃ  sdb vÃ  sdc cho RAID báº±ng lá»‡nh fdisk.

 **Táº¡o phÃ¢n vÃ¹ng trÃªn á»• Ä‘Ä©a sdb**.

* Cháº¡y lá»‡nh fdisk /dev/sdb Ä‘á»ƒ táº¡o phÃ¢n vÃ¹ng cho sdb vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c sau:

   * Nháº¥n n Ä‘á»ƒ táº¡o phÃ¢n vÃ¹ng má»›i.
   * Sau Ä‘Ã³ chá»n p cho phÃ¢n vÃ¹ng chÃ­nh.
   * Tiáº¿p theo chá»n sá»‘ phÃ¢n vÃ¹ng lÃ  1 .
   * Nháº­p giÃ¡ trá»‹ ban Ä‘áº§u, giÃ¡ trá»‹ káº¿t thÃºc vÃ  nháº¥n phÃ­m Enter.
   * Tiáº¿p theo nháº¥n p Ä‘á»ƒ in phÃ¢n vÃ¹ng Ä‘Ã£ Ä‘Æ°á»£c táº¡o.
* Thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau Ä‘Ã¢y Ä‘á»ƒ táº¡o Linux RAID tá»± Ä‘á»™ng trÃªn cÃ¡c phÃ¢n vÃ¹ng:
   * Nháº¥n L Ä‘á»ƒ liá»‡t kÃª táº¥t cáº£ cÃ¡c loáº¡i cÃ³ sáºµn.
   * Nháº­p t Ä‘á»ƒ chá»n phÃ¢n vÃ¹ng.
   * Nháº­p fd Ä‘á»ƒ chá»n Linux RAID tá»± Ä‘á»™ng vÃ  nháº¥n Enter Ä‘á»ƒ Ã¡p dá»¥ng.
   * Sá»­ dá»¥ng phÃ­m p Ä‘á»ƒ in nhá»¯ng thay Ä‘á»•i.
   * Cuá»‘i cÃ¹ng chÃºng ta nháº¥n phÃ­m w lÆ°u cÃ¡c thay Ä‘á»•i.
* CÃ¡c thao tÃ¡c trÃªn Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° sau:
```
[root@localhost ~]# fdisk /dev/sdb
Welcome to fdisk (util-linux 2.23.2).

Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table
Building a new DOS disklabel with disk identifier 0xd1c9ae6a.

Command (m for help): n
Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): p
Partition number (1-4, default 1): 1
First sector (2048-20971519, default 2048): 2048
Last sector, +sectors or +size{K,M,G} (2048-20971519, default 20971519): 20971519
Partition 1 of type Linux and of size 10 GiB is set

Command (m for help): p

Disk /dev/sdb: 10.7 GB, 10737418240 bytes, 20971520 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk label type: dos
Disk identifier: 0xd1c9ae6a

   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1            2048    20971519    10484736   83  Linux

Command (m for help): L

 0  Empty           24  NEC DOS         81  Minix / old Lin bf  Solaris
 1  FAT12           27  Hidden NTFS Win 82  Linux swap / So c1  DRDOS/sec (FAT-
 2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec (FAT-
 3  XENIX usr       3c  PartitionMagic  84  OS/2 hidden C:  c6  DRDOS/sec (FAT-
 4  FAT16 <32M      40  Venix 80286     85  Linux extended  c7  Syrinx
 5  Extended        41  PPC PReP Boot   86  NTFS volume set da  Non-FS data
 6  FAT16           42  SFS             87  NTFS volume set db  CP/M / CTOS / .
 7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux plaintext de  Dell Utility
 8  AIX             4e  QNX4.x 2nd part 8e  Linux LVM       df  BootIt
 9  AIX bootable    4f  QNX4.x 3rd part 93  Amoeba          e1  DOS access
 a  OS/2 Boot Manag 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O
 b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor
 c  W95 FAT32 (LBA) 52  CP/M            a0  IBM Thinkpad hi eb  BeOS fs
 e  W95 FAT16 (LBA) 53  OnTrack DM6 Aux a5  FreeBSD         ee  GPT
 f  W95 Ext'd (LBA) 54  OnTrackDM6      a6  OpenBSD         ef  EFI (FAT-12/16/
10  OPUS            55  EZ-Drive        a7  NeXTSTEP        f0  Linux/PA-RISC b
11  Hidden FAT12    56  Golden Bow      a8  Darwin UFS      f1  SpeedStor
12  Compaq diagnost 5c  Priam Edisk     a9  NetBSD          f4  SpeedStor
14  Hidden FAT16 <3 61  SpeedStor       ab  Darwin boot     f2  DOS secondary
16  Hidden FAT16    63  GNU HURD or Sys af  HFS / HFS+      fb  VMware VMFS
17  Hidden HPFS/NTF 64  Novell Netware  b7  BSDI fs         fc  VMware VMKCORE
18  AST SmartSleep  65  Novell Netware  b8  BSDI swap       fd  Linux raid auto
1b  Hidden W95 FAT3 70  DiskSecure Mult bb  Boot Wizard hid fe  LANstep
1c  Hidden W95 FAT3 75  PC/IX           be  Solaris boot    ff  BBT
1e  Hidden W95 FAT1 80  Old Minix

Command (m for help): t
Selected partition 1
Hex code (type L to list all codes): fd
Changed type of partition 'Linux' to 'Linux raid autodetect'

Command (m for help): p

Disk /dev/sdb: 10.7 GB, 10737418240 bytes, 20971520 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk label type: dos
Disk identifier: 0xd1c9ae6a

   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1            2048    20971519    10484736   fd  Linux raid autodetect

Command (m for help): w
The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
```

* TÆ°Æ¡ng tá»± nhÆ° váº­y chÃºng ta táº¡o phÃ¢n vÃ¹ng cho `sdc`.

* Sau khi táº¡o xong chÃºng ta cháº¡y lá»‡nh bÃªn dÆ°á»›i kiá»ƒm tra xem phÃ¢n vÃ¹ng Ä‘Æ°á»£c táº¡o hay chÆ°a.
```
[root@localhost ~]# fdisk -l | grep sd
Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors
/dev/sda1   *        2048     2099199     1048576   83  Linux
/dev/sda2         2099200    41943039    19921920   8e  Linux LVM
Disk /dev/sdb: 10.7 GB, 10737418240 bytes, 20971520 sectors
/dev/sdb1            2048    20971519    10484736   fd  Linux raid autodetect
Disk /dev/sdc: 10.7 GB, 10737418240 bytes, 20971520 sectors
/dev/sdc1            2048    20971519    10484736   fd  Linux raid autodetect
```

* Tiáº¿p theo chÃºng ta cháº¡y lá»‡nh bÃªn dÆ°á»›i Ä‘á»ƒ kiá»ƒm tra xem cÃ¡c Ä‘Ä©a hiá»‡n cÃ³ tham gia RAID nÃ o khÃ´ng:
* 
```
[root@localhost ~]#  mdadm --examine /dev/sd[b-c]
/dev/sdb:
   MBR Magic : aa55
Partition[0] :     20969472 sectors at         2048 (type fd)
/dev/sdc:
   MBR Magic : aa55
Partition[0] :     20969472 sectors at         2048 (type fd)
[root@localhost ~]#  mdadm --examine /dev/sd[b-c]1
mdadm: No md superblock detected on /dev/sdb1.
mdadm: No md superblock detected on /dev/sdc1.
```
#### BÆ°á»›c 4: Táº¡o RAID0

* ChÃºng ta cháº¡y lá»‡nh sau Ä‘á»ƒ táº¡o RAID0:

```
[root@localhost ~]# mdadm -C /dev/md0 -l raid0 -n 2 /dev/sd[b-c]1
mdadm: Defaulting to version 1.2 metadata
mdadm: array /dev/md0 started.
```
* Trong Ä‘Ã³:

   * C: Táº¡o RAID má»›i.
   * l: Level cá»§a RAID.
   * n: KhÃ´ng cÃ³ thiáº¿t bá»‹ RAID.
* NgoÃ i ra lá»‡nh táº¡o RAID0 sau Ä‘Ã¢y cÅ©ng cÃ³ Ã½ nghÄ©a nhÆ° lá»‡nh chÃºng ta vá»«a cháº¡y:
```
mdadm --create /dev/md0 --level=stripe --raid-devices=2 /dev/sd[b-c]1
```

* Kiá»ƒm tra láº¡i RAID vá»«a táº¡o báº±ng cÃ¡c cÃ¡ch sau:

```
[root@localhost ~]# cat /proc/mdstat
Personalities : [raid0]
md0 : active raid0 sdc1[1] sdb1[0]
      20951040 blocks super 1.2 512k chunks

unused devices: <none>
```

* Qua káº¿t quáº£ trÃªn cho chÃºng ta tháº¥y RAID0 Ä‘Ã£ Ä‘Æ°á»£c táº¡o vá»›i hai phÃ¢n vÃ¹ng `sdb1` vÃ  `sdc1`. ChÃºng ta cÅ©ng cÃ³ thá»ƒ kiá»ƒm tra báº±ng lá»‡nh bÃªn dÆ°á»›i:

```
[root@localhost ~]# mdadm -E /dev/sd[b-c]1
/dev/sdb1:
          Magic : a92b4efc
        Version : 1.2
    Feature Map : 0x0
     Array UUID : 98cffedb:dd23fd6d:07b60209:b92643bd
           Name : localhost.localdomain:0  (local to host localhost.localdomain)
  Creation Time : Sun May 19 11:40:09 2019
     Raid Level : raid0
   Raid Devices : 2

 Avail Dev Size : 20951040 (9.99 GiB 10.73 GB)
    Data Offset : 18432 sectors
   Super Offset : 8 sectors
   Unused Space : before=18352 sectors, after=0 sectors
          State : clean
    Device UUID : fedf81e4:0cea1e46:3f96f2c1:9c4fa897

    Update Time : Sun May 19 11:40:09 2019
  Bad Block Log : 512 entries available at offset 8 sectors
       Checksum : af1ccef - correct
         Events : 0

     Chunk Size : 512K

   Device Role : Active device 0
   Array State : AA ('A' == active, '.' == missing, 'R' == replacing)
/dev/sdc1:
          Magic : a92b4efc
        Version : 1.2
    Feature Map : 0x0
     Array UUID : 98cffedb:dd23fd6d:07b60209:b92643bd
           Name : localhost.localdomain:0  (local to host localhost.localdomain)
  Creation Time : Sun May 19 11:40:09 2019
     Raid Level : raid0
   Raid Devices : 2

 Avail Dev Size : 20951040 (9.99 GiB 10.73 GB)
    Data Offset : 18432 sectors
   Super Offset : 8 sectors
   Unused Space : before=18352 sectors, after=0 sectors
          State : clean
    Device UUID : 7abd085c:5144fc8f:5a200101:4a70369c

    Update Time : Sun May 19 11:40:09 2019
  Bad Block Log : 512 entries available at offset 8 sectors
       Checksum : ff2af79 - correct
         Events : 0

     Chunk Size : 512K

   Device Role : Active device 1
   Array State : AA ('A' == active, '.' == missing, 'R' == replacing)
   ```
   
* Hoáº·c cÃ³ thá»ƒ cháº¡y lá»‡nh sau Ä‘á»ƒ kiá»ƒm tra:

```
[root@localhost ~]# mdadm --detail /dev/md0
/dev/md0:
           Version : 1.2
     Creation Time : Sun May 19 11:40:09 2019
        Raid Level : raid0
        Array Size : 20951040 (19.98 GiB 21.45 GB)
      Raid Devices : 2
     Total Devices : 2
       Persistence : Superblock is persistent

       Update Time : Sun May 19 11:40:09 2019
             State : clean
    Active Devices : 2
   Working Devices : 2
    Failed Devices : 0
     Spare Devices : 0

        Chunk Size : 512K

Consistency Policy : none

              Name : localhost.localdomain:0  (local to host localhost.localdomain)
              UUID : 98cffedb:dd23fd6d:07b60209:b92643bd
            Events : 0

    Number   Major   Minor   RaidDevice State
       0       8       17        0      active sync   /dev/sdb1
       1       8       33        1      active sync   /dev/sdc1
       ```
       
       
#### BÆ°á»›c 5: Táº¡o file system (ext4) cho thiáº¿t bá»‹ RAID /dev/md0

[root@localhost ~]#  mkfs.ext4 /dev/md0
mke2fs 1.42.9 (28-Dec-2013)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
Stride=128 blocks, Stripe width=256 blocks
1310720 inodes, 5237760 blocks
261888 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=2153775104
160 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks:
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,
	4096000

Allocating group tables: done
Writing inode tables: done
Creating journal (32768 blocks): done
Writing superblocks and filesystem accounting information: done
Tiáº¿p theo táº¡o thÆ° má»¥c gáº¯n káº¿t raid0 Ä‘á»ƒ gáº¯n thiáº¿t bá»‹ /dev/md0 thá»±c hiá»‡n nhÆ° bÃªn dÆ°á»›i.

[root@localhost ~]# mkdir raid0
[root@localhost ~]# mount /dev/md0 raid0/
Tiáº¿p theo, cháº¡y lá»‡nh df Ä‘á»ƒ kiá»ƒm tra xem thiáº¿t bá»‹ /dev/md0 Ä‘Æ°á»£c gáº¯n trong thÆ° má»¥c /root/raid0 khÃ´ng.

[root@localhost ~]# df -h
Filesystem           Size  Used Avail Use% Mounted on
/dev/mapper/cl-root   17G  1.3G   16G   8% /
devtmpfs             475M     0  475M   0% /dev
tmpfs                487M     0  487M   0% /dev/shm
tmpfs                487M  7.7M  479M   2% /run
tmpfs                487M     0  487M   0% /sys/fs/cgroup
/dev/sda1           1014M  201M  814M  20% /boot
tmpfs                 98M     0   98M   0% /run/user/0
/dev/md0             9.8G   37M  9.2G   1% /root/raid0
Táº¡o má»™t tá»‡p raid0/test0.txt, thÃªm ná»™i dung vÃ o tá»‡p Ä‘Ã£ táº¡o vÃ  xem ná»™i dung cá»§a tá»‡p.

[root@localhost ~]# ls -l raid0/
total 20
drwx------. 2 root root 16384 May 19 13:36 lost+found
[root@localhost ~]# echo "This is RAID0" > raid0/test0.txt
[root@localhost ~]# cat raid0/test0.txt
This is RAID0
Thiáº¿t bá»‹ /dev/md0 gáº¯n káº¿t cá»§a chÃºng ta lÃ  táº¡m thá»i. Náº¿u há»‡ Ä‘iá»u hÃ nh Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng láº¡i, cÃ¡c thÆ° má»¥c Ä‘Æ°á»£c gáº¯n káº¿t nÃ y sáº½ bá»‹ máº¥t. VÃ¬ váº­y, chÃºng ta cáº§n pháº£i gáº¯n káº¿t vÄ©nh viá»…n. Äá»ƒ thá»±c hiá»‡n gáº¯n káº¿t vÄ©nh viá»…n pháº£i nháº­p trong tá»‡p /etc/fstab. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trÃ¬nh soáº¡n tháº£o vi Ä‘á»ƒ nháº­p dÃ²ng bÃªn dÆ°á»›i vÃ o:

/dev/md0        raid0   ext4    defaults        0 0
Thá»±c hiá»‡n nhÆ° sau:

[root@localhost ~]# vi /etc/fstab

#
# /etc/fstab
# Created by anaconda on Tue May 14 10:34:53 2019
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=58253f4e-01e2-47c8-8f0c-49a1e5b0b7bf /boot                   xfs     defaults        0 0
/dev/mapper/cl-swap     swap                    swap    defaults        0 0
/dev/md0        raid0   ext4    defaults        0 0
LÆ°u láº¡i file /etc/fstab vÃ  cháº¡y lá»‡nh:

[root@localhost ~]# mount -a
[root@localhost ~]# mount -av
/                        : ignored
/boot                    : already mounted
swap                     : ignored
raid0                    : already mounted
Náº¿u cÃ³ lá»—i, khÃ´ng reboot server Ä‘á»ƒ trÃ¡nh tÃ¬nh tráº¡ng server khÃ´ng thá»ƒ khá»Ÿi Ä‘á»™ng. Kiá»ƒm tra cáº¥u hÃ¬nh trong file /etc/fstab vÃ  cháº¡y láº¡i lá»‡nh cho tá»›i khi khÃ´ng cÃ³ thÃ´ng bÃ¡o lá»—i.

ğŸ‘‰ BÆ°á»›c 6: LÆ°u cáº¥u hÃ¬nh RAID

LÆ°u cáº¥u hÃ¬nh RAID vÃ o má»™t tá»‡p Ä‘á»ƒ giá»¯ cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng trong tÆ°Æ¡ng lai.

ChÃºng ta sá»­ dá»¥ng lá»‡nh mdadm vá»›i cÃ¡c tÃ¹y chá»n -s(quÃ©t) vÃ  -v (dÃ i dÃ²ng) nhÆ° sau:

[root@localhost ~]# mdadm -E -s -v >> /etc/mdadm.conf
[root@localhost ~]# cat /etc/mdadm.conf
ARRAY /dev/md/0  level=raid0 metadata=1.2 num-devices=2 UUID=98cffedb:dd23fd6d:07b60209:b92643bd name=localhost.localdomain:0
   devices=/dev/sdc1,/dev/sdb1
Qua cÃ¡c bÆ°á»›c trÃªn chÃºng ta Ä‘Ã£ táº¡o thÃ nh cÃ´ng RAID0 trÃªn Centos
